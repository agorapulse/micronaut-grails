<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Vladimir Orany">
<title>Grails Integration for Micronaut</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css/docs.css?v=3.1.2-micronaut-3.0" />
<style>
.hidden {
    display: none;
}

.switch {
    border-width: 1px 1px 0 1px;
    border-style: solid;
    border-color: #7a2518;
    display: inline-block;
}

.switch--item {
    padding: 10px;
    background-color: #ffffff;
    color: #7a2518;
    display: inline-block;
    cursor: pointer;
}

.switch--item.selected {
    background-color: #7a2519;
    color: #ffffff;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script type="text/javascript">
function addBlockSwitches() {
    $('.primary').each(function() {
        primary = $(this);
        createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
        primary.children('.title').remove();
    });
    $('.secondary').each(function(idx, node) {
        secondary = $(node);
        primary = findPrimary(secondary);
        switchItem = createSwitchItem(secondary, primary.children('.switch'));
        switchItem.content.addClass('hidden');
        findPrimary(secondary).append(switchItem.content);
        secondary.remove();
    });
}

function createBlockSwitch(primary) {
    blockSwitch = $('<div class="switch"></div>');
    primary.prepend(blockSwitch);
    return blockSwitch;
}

function findPrimary(secondary) {
    candidate = secondary.prev();
    while (!candidate.is('.primary')) {
        candidate = candidate.prev();
    }
    return candidate;
}

function createSwitchItem(block, blockSwitch) {
    blockName = block.children('.title').text();
    content = block.children('.content').first().append(block.next('.colist'));
    item = $('<div class="switch--item">' + blockName + '</div>');
    item.on('click', '', content, function(e) {
        $(this).addClass('selected');
        $(this).siblings().removeClass('selected');
        e.data.siblings('.content').addClass('hidden');
        e.data.removeClass('hidden');
    });
    blockSwitch.append(item);
    return {'item': item, 'content': content};
}

$(addBlockSwitches);

</script>

</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Grails Integration for Micronaut</h1>
<div class="details">
<span id="author" class="author">Vladimir Orany</span><br>
<span id="revnumber">version 3.1.2-micronaut-3.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_micronaut_grails">1. Micronaut Grails</a>
<ul class="sectlevel2">
<li><a href="#_grails_4">1.1. Grails 4</a>
<ul class="sectlevel3">
<li><a href="#_installation">1.1.1. Installation</a></li>
<li><a href="#_usage">1.1.2. Usage</a>
<ul class="sectlevel4">
<li><a href="#_compatibility_modes">Compatibility Modes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_grails_3">1.2. Grails 3</a>
<ul class="sectlevel3">
<li><a href="#_installation_2">1.2.1. Installation</a></li>
<li><a href="#_usage_2">1.2.2. Usage</a></li>
</ul>
</li>
<li><a href="#_integration_tests">1.3. Integration Tests</a></li>
<li><a href="#_gorm_to_micronaut_data_jpa_generator">1.4. GORM to Micronaut Data JPA Generator</a>
<ul class="sectlevel3">
<li><a href="#_installation_3">1.4.1. Installation</a></li>
<li><a href="#_usage_3">1.4.2. Usage</a></li>
<li><a href="#_generated_entities_example">1.4.3. Generated Entities Example</a></li>
</ul>
</li>
<li><a href="#_troubleshooting">1.5. Troubleshooting</a>
<ul class="sectlevel3">
<li><a href="#_dumping_configuration_properties">1.5.1. Dumping Configuration Properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_links">2. Links</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock ribbon">
<div class="content">
<a class="image" href="https://github.com/agorapulse/micronaut-grails"><img src="images/ribbon.png" alt="ribbon"></a>
</div>
</div>
<div class="imageblock left">
<div class="content">
<a class="image" href="https://search.maven.org/search?q=g:%22com.agorapulse%22%20AND%20a:%22micronaut-grails%22"><img src="https://img.shields.io/maven-central/v/com.agorapulse/micronaut-grails.svg?label=Maven%20Central" alt="micronaut grails"></a>
</div>
</div>
<div class="imageblock left">
<div class="content">
<a class="image" href="https://github.com/agorapulse/micronaut-grails/actions?query=workflow%3ACheck"><img src="https://github.com/agorapulse/micronaut-grails/workflows/Check/badge.svg" alt="Build Status"></a>
</div>
</div>
<div class="imageblock left">
<div class="content">
<a class="image" href="https://coveralls.io/github/agorapulse/micronaut-grails?branch=master""><img src="https://coveralls.io/repos/github/agorapulse/micronaut-grails/badge.svg?branch=master" alt="badge"></a>
</div>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_micronaut_grails"><a class="anchor" href="#_micronaut_grails"></a>1. Micronaut Grails</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_grails_4"><a class="anchor" href="#_grails_4"></a>1.1. Grails 4</h3>
<div class="sect3">
<h4 id="_installation"><a class="anchor" href="#_installation"></a>1.1.1. Installation</h4>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>compile 'com.agorapulse:micronaut-grails:3.1.2-micronaut-3.0'

// for Tomcat deployment replace
// compile 'org.grails:grails-web-boot'
// with
compile 'com.agorapulse:micronaut-grails-web-boot:3.1.2-micronaut-3.0'</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you plan to reuse same library for Micronaut and Grails, you can declare the dependency as  <code>compileOnly</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage"><a class="anchor" href="#_usage"></a>1.1.2. Usage</h4>
<div class="paragraph">
<p>Micronaut Grails library helps to use Micronaut beans in the Grails 4 application or any other Spring application.
The main additional feature is the ability to do more customisation to the Micronaut context such as adding a package for scanning.</p>
</div>
<div class="paragraph">
<p>Replace the body of the <code>main</code> method inside <code>grails-app/init/&#8230;&#8203;/Application.groovy</code> with the following code.</p>
</div>
<div class="listingblock">
<div class="title">Grails 4 Usage</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">import com.agorapulse.micronaut.grails.CompatibilityMode
import com.agorapulse.micronaut.grails.EnvVarLikeSystemPropertiesPropertySource
import com.agorapulse.micronaut.grails.MicronautGrailsApp
import com.agorapulse.micronaut.grails.MicronautGrailsAutoConfiguration
import com.agorapulse.micronaut.grails.domain.Manager
import groovy.transform.CompileStatic
import io.micronaut.context.env.Environment
import org.springframework.context.ConfigurableApplicationContext

@CompileStatic
class Application extends MicronautGrailsAutoConfiguration {                            <i class="conum" data-value="1"></i><b>(1)</b>

    static ConfigurableApplicationContext context

    static void main(String[] args) {
        context = MicronautGrailsApp.run(Application, args)                             <i class="conum" data-value="2"></i><b>(2)</b>
    }

    final CompatibilityMode compatibilityMode = CompatibilityMode.STRICT                <i class="conum" data-value="3"></i><b>(3)</b>
    final Collection&lt;Package&gt; packages = [                                              <i class="conum" data-value="4"></i><b>(4)</b>
        Manager.package,
    ]

    @Override
    protected void doWithMicronautEnvironment(Environment env) {
        env.addPropertySource(new EnvVarLikeSystemPropertiesPropertySource())           <i class="conum" data-value="5"></i><b>(5)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Your <code>Application</code> class must extend <code>MicronautGrailsAutoConfiguration</code> class</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use <code>MicronautGrailsApp</code> instead of <code>GrailsApp</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>You can set the compatibility mode (see below - defaults to <code>STRICT</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>You can customize the packages for scanning</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>You can customize the Micronaut environment</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_compatibility_modes"><a class="anchor" href="#_compatibility_modes"></a>Compatibility Modes</h5>
<div class="paragraph">
<p>The compatibility mode signals what is the level of compatibility with the legacy features mentioned in Grails 3 section.
The default is <code>STRICT</code> which means no features are enabled and Grails 4 Micronaut out-of-box integration is used.
If you are migrating from Grails 3 then you should select <code>LEGACY</code> and enable <code>com.agorapulse.micronaut.grails</code> logging
to <code>INFO</code> to see the deprecation details.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">LEGACY</th>
<th class="tableblock halign-left valign-top">BRIDGE</th>
<th class="tableblock halign-left valign-top">STRICT</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single Application Context</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>No</em> then two application contexts are created - one for beans using <code>@Inject</code> and another one for beans injected by name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Injection by Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>No</em> then the beans require <code>@Inject</code> annotation at the injection point, and they can be no longer injected by name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property Translation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>No</em> then Spring beans of type <code>PropertyTranslatingcustomiser</code> are ignored prefix replacements no longer work. Otherwise, the customization applies to all beans injected by name (not using <code>@Inject</code>).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grails_3"><a class="anchor" href="#_grails_3"></a>1.2. Grails 3</h3>
<div class="sect3">
<h4 id="_installation_2"><a class="anchor" href="#_installation_2"></a>1.2.1. Installation</h4>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>compileOnly 'com.agorapulse:micronaut-grails:3.1.2-micronaut-3.0'</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you plan to reuse same library for Micronaut and Grails, you can declare the dependency as  <code>compileOnly</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_2"><a class="anchor" href="#_usage_2"></a>1.2.2. Usage</h4>
<div class="paragraph">
<p>Micronaut Grails library helps to use Micronaut beans in the Grails 3 application or any other Spring application.
There are three additional features which cannot be found the official <a href="https://micronaut-projects.github.io/micronaut-spring/latest/guide/">Spring support for Micronaut</a>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ability to modify Micronaut environment (e.g. add packages for scanning)</p>
</li>
<li>
<p>Micronaut beans' names defaults to lower-cased simple name of the class as expected by Grails</p>
</li>
<li>
<p>Ability to reuse existing properties declared by Grails - e.g. <code>grails.redis.port</code> can be injected as <code>@Value('${redis.port}')</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The integration is handled by bean processor which needs to be injected into Spring application context. The easiest
thing is to create Spring configuration placed next to your Micronaut classes. The Spring configuration class will
create <code>MicronautBeanImporter</code> which will be later processed by the processor bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">@CompileStatic
@Configuration                                                                          <i class="conum" data-value="1"></i><b>(1)</b>
class GrailsConfig {

    @Bean
    MicronautBeanImporter myImporter() {                                                <i class="conum" data-value="2"></i><b>(2)</b>
        return MicronautBeanImporter.create()
            .addByType(Widget)                                                          <i class="conum" data-value="3"></i><b>(3)</b>
            .addByType('someInterface', SomeInterface)                                  <i class="conum" data-value="4"></i><b>(4)</b>
            .addByStereotype('custom', SomeCustomScope)                                 <i class="conum" data-value="5"></i><b>(5)</b>
            .addByName('gadget')                                                        <i class="conum" data-value="6"></i><b>(6)</b>
            .addByName('one')
            .addByName('two')
            .addByQualifiers(                                                           <i class="conum" data-value="7"></i><b>(7)</b>
                'otherMinion',
                Qualifiers.byName('other'),
                Qualifiers.byType(Minion)
            )
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Define class as Spring <code>@Configuration</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Declare method which returns bean processor <code>@Bean</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the Spring bean defaults to the <em>property name</em> of the class, e.g. <code>widget</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>You can provide a different name</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>You can qualify using a stereotype (annotation)</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>You can qualify using the name of the bean which will be the same in the Spring application</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>You can combine any qualifiers possible to narrow the search to single bean which needs to be available from the Spring application context</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If more than one bean qualifies the criteria then an exception will be thrown.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you have your configuration class ready then you can create <code>META-INF/spring.factories</code> descriptor in resources folder
which will automatically load the configuration once the JAR is on classpath.</p>
</div>
<div class="listingblock">
<div class="title">META-INF/spring.factories</div>
<div class="content">
<pre>org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.agorapulse.micronaut.grails.example.GrailsConfig</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_integration_tests"><a class="anchor" href="#_integration_tests"></a>1.3. Integration Tests</h3>
<div class="paragraph">
<p>If you want to take advantage of additional features provided by <code>MicronautGrailsApp</code> such additional package scanning inside integration tests then you need to use a following extension of the standard testing library:</p>
</div>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>compile 'com.agorapulse:micronaut-grails-integration-test:3.1.2-micronaut-3.0'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the library is on the classpath, use <code>@MicronautGrailsIntegration</code> instead of <code>@Inegration</code> annotation to achieve the similar result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">import com.agorapulse.micronaut.grails.jpa.generator.MicronautJpaGenerator
import com.agorapulse.micronaut.grails.test.MicronautGrailsIntegration
import org.springframework.beans.factory.annotation.Autowired
import spock.lang.Specification

@MicronautGrailsIntegration
class IntegrationSpec extends Specification {

    @Autowired MicronautJpaGenerator generator

    void 'application started'() {
        expect:
            new URL("http://localhost:$serverPort/test/health").text == 'OK'
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gorm_to_micronaut_data_jpa_generator"><a class="anchor" href="#_gorm_to_micronaut_data_jpa_generator"></a>1.4. GORM to Micronaut Data JPA Generator</h3>
<div class="sect3">
<h4 id="_installation_3"><a class="anchor" href="#_installation_3"></a>1.4.1. Installation</h4>
<div class="listingblock primary">
<div class="title">Gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code>testImplementation 'com.agorapulse:micronaut-grails-jpa-generator:3.1.2-micronaut-3.0'</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_usage_3"><a class="anchor" href="#_usage_3"></a>1.4.2. Usage</h4>
<div class="paragraph">
<p>There is an experimental generator for the JPA entities from GORM domain classes. You can use either from integration test or using Grails Console plugin</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can use <code>MicronautJdbcGenrator</code> instead of <code>MicronautJpaGenerator</code> to generate JDBC repositories instead of generic ones.
</td>
</tr>
</table>
</div>
<div class="listingblock primary">
<div class="title">Grails Integration Test Usage</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">import com.agorapulse.micronaut.grails.jpa.generator.MicronautJpaGenerator
import com.agorapulse.micronaut.grails.test.MicronautGrailsIntegration
import com.agorapulse.testing.fixt.Fixt
import org.springframework.beans.factory.annotation.Autowired
import spock.lang.Specification

@MicronautGrailsIntegration
class GeneratorSpec extends Specification {

    Fixt fixt = Fixt.create(GeneratorSpec)

    @Autowired MicronautJpaGenerator generator

    void 'generate domains'() {
        given:
            File root = initRootDirectory()
        when:
            generator.generate(root)
        then:
            noExceptionThrown()

        when:
            File entityFile = new File(root, 'micronaut/grails/example/model/User.groovy')
            File repositoryFile = new File(root, 'micronaut/grails/example/model/UserRepository.groovy')
        then:
            entityFile.exists()
            entityFile.text.trim() == fixt.readText('User.groovy.txt').trim()

            repositoryFile.exists()
            repositoryFile.text.trim() == fixt.readText('UserRepository.groovy.txt').trim()
    }

    private static File initRootDirectory() {
        File root = new File(System.getProperty('java.io.tmpdir'), 'micronaut-data-model')

        if (root.exists()) {
            root.deleteDir()
        }

        root.mkdirs()

        return root
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Micronaut Test Usage</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">import com.agorapulse.micronaut.grails.jpa.generator.MicronautJpaGenerator
import com.agorapulse.testing.fixt.Fixt
import groovy.transform.CompileDynamic
import io.micronaut.context.ApplicationContext
import org.grails.datastore.gorm.validation.constraints.eval.DefaultConstraintEvaluator
import org.grails.orm.hibernate.HibernateDatastore
import spock.lang.AutoCleanup
import spock.lang.Specification

/**
 * Example specification generating JPA entities from GORM entities.
 */
@CompileDynamic
class MicronautGeneratorSpec extends Specification {

    Fixt fixt = Fixt.create(MicronautGeneratorSpec)

    @AutoCleanup ApplicationContext context = ApplicationContext.run()

    MicronautJpaGenerator generator = new MicronautJpaGenerator(
        context.getBean(HibernateDatastore),
        new DefaultConstraintEvaluator()
    )

    void 'generate domains'() {
        given:
            File root = initRootDirectory()
        when:
            generator.generate(root)
        then:
            noExceptionThrown()

        when:
            File entityFile = new File(root, 'com/agorapulse/micronaut/grails/domain/model/Manager.groovy')
            File repositoryFile = new File(root, 'com/agorapulse/micronaut/grails/domain/model/ManagerRepository.groovy')
        then:
            entityFile.exists()
            entityFile.text.trim() == fixt.readText('Manager.groovy.txt').trim()

            repositoryFile.exists()
            repositoryFile.text.trim() == fixt.readText('ManagerRepository.groovy.txt').trim()
    }

    private static File initRootDirectory() {
        File root = new File(System.getProperty('java.io.tmpdir'), 'micronaut-data-model')

        if (root.exists()) {
            root.deleteDir()
        }

        root.mkdirs()

        return root
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Grails Console Usage</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">ctx.micronautJpaGenerator.generate(new File('/path/to/generated/sources'))</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Micronaut Console Usage</div>
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">import com.agorapulse.micronaut.grails.jpa.generator.MicronautJpaGenerator
import org.grails.datastore.gorm.validation.constraints.eval.DefaultConstraintEvaluator
import org.grails.orm.hibernate.HibernateDatastore

new MicronautJpaGenerator(
    ctx.getBean(HibernateDatastore),
    new DefaultConstraintEvaluator()
).generate(new File('/path/to/generated/sources'))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The current generator supports</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Constraints</p>
</li>
<li>
<p>Column mappings</p>
</li>
<li>
<p>One-to-One, One-to-Many and Many-to-One relationships</p>
</li>
<li>
<p>Join Tables</p>
</li>
<li>
<p>Unique and regular indices</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please, let us know if there is any feature missing!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The new entities are generated it to the packages with suffix <code>.model</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_generated_entities_example"><a class="anchor" href="#_generated_entities_example"></a>1.4.3. Generated Entities Example</h4>
<div class="paragraph">
<p>For an <code>User</code> entity such as this one</p>
</div>
<div class="listingblock">
<div class="title">GORM Entity</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">package micronaut.grails.example

import grails.compiler.GrailsCompileStatic
import micronaut.grails.example.other.Vehicle

@GrailsCompileStatic
class User {

    String userName
    String password
    String email

    static hasMany = [vehicles: Vehicle]

    static constraints = {
        userName blank: false, unique: true
        password size: 5..10, blank: false
        email email: true, blank: true
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following files are generated</p>
</div>
<div class="listingblock">
<div class="title">Micronaut Data JPA Entity</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">package micronaut.grails.example.model

import groovy.transform.CompileStatic
import javax.persistence.Entity
import javax.persistence.GeneratedValue
import javax.persistence.GenerationType
import javax.persistence.Id
import javax.persistence.OneToMany
import javax.persistence.Table
import javax.persistence.UniqueConstraint
import javax.persistence.Version
import javax.validation.constraints.Email
import javax.validation.constraints.NotBlank
import javax.validation.constraints.NotNull
import javax.validation.constraints.Size
import micronaut.grails.example.other.model.Vehicle

@Entity
@CompileStatic
@Table(
    uniqueConstraints = [
        @UniqueConstraint(columnNames = ['user_name'])
    ]
)
class User {

    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    Long id

    @Version
    Long version

    @NotNull
    @Email
    @Size(max = 255)
    String email

    @NotNull
    @Size(min = 5, max = 10)
    @NotBlank
    @Size(min = 5, max = 10)
    String password

    @NotNull
    @NotBlank
    @Size(max = 255)
    String userName

    @OneToMany
    Set&lt;Vehicle&gt; vehicles

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Micronaut Data Repository</div>
<div class="content">
<pre class="prettyprint highlight"><code data-lang="groovy">package micronaut.grails.example.model

import io.micronaut.data.annotation.Repository
import io.micronaut.data.repository.CrudRepository

@Repository
interface UserRepository extends CrudRepository&lt;User, Long&gt; {

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>1.5. Troubleshooting</h3>
<div class="sect3">
<h4 id="_dumping_configuration_properties"><a class="anchor" href="#_dumping_configuration_properties"></a>1.5.1. Dumping Configuration Properties</h4>
<div class="paragraph">
<p>The configuration properties inside Grails may behave bit differently than inside Micronaut application. If you are using Grails Console plugin then you can dump all the properties available using the following script</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight nowrap"><code data-lang="groovy">def mc = ctx.getBean(com.agorapulse.micronaut.grails.MicronautContextHolder).context
def env = mc.environment
def sources = env.propertySources


for (source in sources) {
    println "$source.name:"
    for (name in source) {
        def value = source.get(name)
        println "  $name (${value?.getClass()}): ${String.valueOf(value)}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links"><a class="anchor" href="#_links"></a>2. Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="api/index.html" target="_blank" rel="noopener">Javadoc</a></p>
</div>
<div class="paragraph">
<p><a href="api-html/index.html" target="_blank" rel="noopener">Source</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.1.2-micronaut-3.0<br>
Last updated 2022-02-09 15:22:55 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>